<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>オーダーシステム</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="order-system" class="order-system">
        <div id="menuScreen">
            <header>
                <h1>メニューをお選びください</h1>
            </header>
            <nav class="menu-nav">
                <button onclick="showMenu('special')" id="limited">期間限定</button>
                <button onclick="showMenu('salad_pasta')" id="salad_pasta">サラダ・パスタ</button>
                <button onclick="showMenu('drinks')" id="drinks">ドリンク</button>
                <button onclick="showMenu('dessert')" id="dessert">デザート</button>
                <button onclick="showMenu('other')" id="other">その他</button>
            </nav>
            <div class="main-content">
                <section class="menu-section">
                    <ul id="menuList">
                        <!-- メニュー項目がここに表示される -->
                    </ul>
                </section>
                <div class="cart">
                    <h2>カート</h2>
                    <ul id="cartList">
                        <!-- カートアイテムがここに表示される -->
                    </ul>
                    <div class="cart-footer">
                        <div class="cart-total">
                            <span>合計金額:</span> <span id="cartTotal">0円</span>
                        </div>
                        <button onclick="submitOrder()">注文を確定する</button>
                    </div>
                </div>
            </div>
            <div class="additional-buttons">
                <button onclick="showOrderHistory()">注文履歴</button>
                <button onclick="callWaiter()">店員呼出</button>
                <button onclick="requestBill()">会計</button>
            </div>
            <div class="allergy-section">
                <button onclick="showAllergyScreen()">アレルギー検索</button>
            </div>
        </div>

        <div id="allergyScreen" class="hidden">
            <header>
                <h2>除外するアレルギー</h2>
            </header>
            <div class="allergy-options">
                <button class="allergy-btn" data-allergy="えび">
                    <img src="allergies/shrimp.png" alt="えび">
                    えび
                </button>
                <button class="allergy-btn" data-allergy="かに">
                    <img src="allergies/crab.png" alt="かに">
                    かに
                </button>
                <button class="allergy-btn" data-allergy="くるみ">
                    <img src="allergies/walnut.png" alt="くるみ">
                    くるみ
                </button>
                <button class="allergy-btn" data-allergy="小麦">
                    <img src="allergies/wheat.png" alt="小麦">
                    小麦
                </button>
                <button class="allergy-btn" data-allergy="そば">
                    <img src="allergies/soba.png" alt="そば">
                    そば
                </button>
                <button class="allergy-btn" data-allergy="卵">
                    <img src="allergies/egg.png" alt="卵">
                    卵
                </button>
                <button class="allergy-btn" data-allergy="乳">
                    <img src="allergies/milk.png" alt="乳">
                    乳
                </button>
                <button class="allergy-btn" data-allergy="落花生">
                    <img src="allergies/peanut.png" alt="落花生">
                    落花生
                </button>
                <button class="allergy-btn" data-allergy="アーモンド">
                    <img src="allergies/almond.png" alt="アーモンド">
                    アーモンド
                </button>
                <button class="allergy-btn" data-allergy="あわび">
                    <img src="allergies/abalone.png" alt="あわび">
                    あわび
                </button>
                <button class="allergy-btn" data-allergy="いか">
                    <img src="allergies/squid.png" alt="いか">
                    いか
                </button>
                <button class="allergy-btn" data-allergy="いくら">
                    <img src="allergies/ikura.png" alt="いくら">
                    いくら
                </button>
                <button class="allergy-btn" data-allergy="オレンジ">
                    <img src="allergies/orange.png" alt="オレンジ">
                    オレンジ
                </button>
                <button class="allergy-btn" data-allergy="カシューナッツ">
                    <img src="allergies/cashew.png" alt="カシューナッツ">
                    カシューナッツ
                </button>
                <button class="allergy-btn" data-allergy="キウイフルーツ">
                    <img src="allergies/kiwi.png" alt="キウイフルーツ">
                    キウイフルーツ
                </button>
                <button class="allergy-btn" data-allergy="牛肉">
                    <img src="allergies/beef.png" alt="牛肉">
                    牛肉
                </button>
                <button class="allergy-btn" data-allergy="ごま">
                    <img src="allergies/sesame.png" alt="ごま">
                    ごま
                </button>
                <button class="allergy-btn" data-allergy="さけ">
                    <img src="allergies/salmon.png" alt="さけ">
                    さけ
                </button>
                <button class="allergy-btn" data-allergy="さば">
                    <img src="allergies/mackerel.png" alt="さば">
                    さば
                </button>
                <button class="allergy-btn" data-allergy="大豆">
                    <img src="allergies/soy.png" alt="大豆">
                    大豆
                </button>
                <button class="allergy-btn" data-allergy="鶏肉">
                    <img src="allergies/chicken.png" alt="鶏肉">
                    鶏肉
                </button>
                <button class="allergy-btn" data-allergy="バナナ">
                    <img src="allergies/banana.png" alt="バナナ">
                    バナナ
                </button>
                <button class="allergy-btn" data-allergy="豚肉">
                    <img src="allergies/pork.png" alt="豚肉">
                    豚肉
                </button>
                <button class="allergy-btn" data-allergy="まつたけ">
                    <img src="allergies/matsutake.png" alt="まつたけ">
                    まつたけ
                </button>
                <button class="allergy-btn" data-allergy="もも">
                    <img src="allergies/peach.png" alt="もも">
                    もも
                </button>
                <button class="allergy-btn" data-allergy="やまいも">
                    <img src="allergies/yam.png" alt="やまいも">
                    やまいも
                </button>
                <button class="allergy-btn" data-allergy="りんご">
                    <img src="allergies/apple.png" alt="りんご">
                    りんご
                </button>
                <button class="allergy-btn" data-allergy="ゼラチン">
                    <img src="allergies/gelatin.png" alt="ゼラチン">
                    ゼラチン
                </button>
            </div>
            <button onclick="applyAllergyFilter()">検索</button>
            <button onclick="showMenuScreen()">戻る</button>
        </div>

    </div>
    <div id="orderConfirmation" class="hidden">
        <!-- この要素に「ご注文ありがとうございました」が表示されます -->
    </div>
<script src="script.js"></script>
<script>
        // ページロード時にサーバーからメニューを取得して表示
        document.addEventListener('DOMContentLoaded', async function () {
            const menus = await fetchMenus(); // script.js で fetchMenus を呼び出す
            if (menus) showMenu('salad_pasta'); // 初期カテゴリを表示（例: サラダ・パスタ）
        });

        // カテゴリ選択時にメニューを更新
        async function showMenu(category) {
            const menus = await fetchMenus();
            const menuList = document.getElementById('menuList');
            menuList.innerHTML = ''; // メニューリストをクリア

            menus
                .filter(menu => menu.genre === category)
                .forEach(menu => {
                    const li = document.createElement('li');
                    li.innerHTML = `
                        <img src="${menu.image}" alt="${menu.name}" style="width:100px;height:100px;">
                        <div>
                            <h4>${menu.name}</h4>
                            <p>${menu.price}円</p>
                            <p>アレルギー: ${menu.allergies.join(', ') || 'なし'}</p>
                        </div>
                        <button onclick="addToCart('${menu.name}', ${menu.price})">カートに追加</button>
                    `;
                    menuList.appendChild(li);
                });
        }
    </script>
</body>
</html>
